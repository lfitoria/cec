{% form_theme form 'bootstrap_4_layout.html.twig' %}
{{ include('commons/_form_header.html.twig', {'current_nav_item': 'info'}) }}
{{ form_start(form, {attr: {class: 'form-request', 'data-number': '1'}}) }}

{% if app.user.role.description == "ROLE_RESEARCHER" %}
  <div class="input-group mb-3 w-50">
    <input type="text" class="form-control add_project_info_input" placeholder="Código del proyecto" aria-label="Código del proyecto" aria-describedby="button-addon2">
    <div class="input-group-append">
      <button type='button' class='add_project_info_button btn btn-primary' data-path="{{ path("get_external_data_by_project_code") }}">Cargar información</button>

    </div>
    <small id="project_request_project_info_help" class="form-text text-muted">Digite el código del proyecto y presione el botón "Cargar información".</small>
  </div> 
  <hr>
  <div class="form-group">
    <label for="project_request_extInstitutions">Título del estudio o investigación:</label>
    <input type="text" readonly class="form-control-plaintext" id="project_title" value="{{ project_info.projectData.nombre|default('No hay dato') }}">
  </div>
  <div class="form-group" id="project_principal_researchers">
    <label for="project_request_extInstitutions">Nombre del investigador (a) principal:</label>
    {% if project_info is not null and project_info.principalResearchers|length > 0 %}
      {% for researcher in project_info.principalResearchers   %}
        <input type="text" readonly class="form-control-plaintext" name="" value="{{ researcher.nombre }} {{ researcher.apellido1 }} {{ researcher.apellido2 }} ">
      {% endfor %}
    {% else %}
      <input type="text" readonly class="form-control-plaintext no-data" name="" value="No hay datos">
    {% endif %}
  </div>
  <div class="form-group">
    <label for="project_request_extInstitutions">Nombre(s) de investigador)es) colaborador(es):</label>
    <table class="table table-striped">
      <thead class="thead-dark">
        <tr>
          <th scope="col">Nombre</th>
          <th scope="col">Cédula</th>
          <th scope="col">Correo institucional</th>
        </tr>
      </thead>
      <tbody class="project_researchers_table">
        {% if project_info is not null and project_info.researchers|length > 0 %}
          {% for researcher in project_info.researchers if researcher.PARTICIPA|trim is same as('ASOCIADO')  %}
            <tr>
              <td scope="col">{{ researcher.nombre }} {{ researcher.apellido1 }} {{ researcher.apellido2 }} </td>
              <td scope="col">{{ researcher.cedula }}</td>
              <td scope="col">{{ researcher.cedula }}</td>
            </tr>
          {% endfor %}
        {% else %}
          <tr class="no-data">
            <td scope="col" colspan="3">No hay investigadores</td>
          </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
  <div class="form-group" id="project_unit">
    <label for="project_request_extInstitutions">Unidad base del proyecto:</label>
    <input type="text" readonly class="form-control-plaintext" name="" value="{{ project_info.projectData.unidad|default('No hay dato') }}">
  </div>
  <div class="form-group">
    <label for="project_request_extInstitutions">Otras unidades e instituciones de la UCR participantes:</label>
    <ul id="project_ucr_units">
      {% if project_info is not null and project_info.externalCollaboration|length > 0 %}
        {% for external in project_info.externalCollaboration  %}
          <li>
            <li scope="col">{{ external.test }} </li>
          </li>
        {% endfor %}
      {% else %}
        <li>
          No hay unidades
        </li>
      {% endif %}
    </ul>
  </div>

{% endif %}
{% if app.user.role.description == "ROLE_STUDENT" %}
  {{ form_row(form.title) }}
  <div class="tutor_information_container">
    <div class="form-group">
      <label for="tutor_information_label" class="required">Director(a) del trabajo final de graduación:</label>
      <div class="form-group row">
        <label for="tutor_name" class="col-sm-3 col-form-label text-right no-label">Nombre del tutor:</label>
        <div class="col-sm-9">
          {{ form_widget(form.tutorName) }}
        </div>
      </div>
      <div class="form-group row">
        <label for="tutor_id" class="col-sm-3 col-form-label text-right no-label">Cédula:</label>
        <div class="col-sm-9">
          {{ form_widget(form.tutorId) }}
        </div>
      </div>
      <div class="form-group row">
        <label for="tutor_name" class="col-sm-3 col-form-label text-right no-label">Correo institucional:</label>
        <div class="col-sm-9">
          {{ form_widget(form.tutorEmail) }}
        </div>
      </div>
    </div>
  </div>
  <div class="inline-custom-radio">
    {{ form_row(form.grupalProject, {attr: {'data-code': 'teamWork', class: 'decision_question'}, label_attr: {class: 'radio-custom'} }) }}
  </div>
  <div id="teamWork" class="d-none">
    <table class="table table-striped">
      <thead class="thead-dark">
        <tr>
          <th scope="col">Nombre</th>
          <th scope="col">Cédula</th>
          <th scope="col">Correo institucional</th>
          <th scope="col">Acciones</th>
        </tr>
      </thead>
      <tbody class="team_work_table">
        {% for team in project_request.teamWork %}
          <tr>
            <td scope="col">{{ team.name }} </td>
            <td scope="col">{{ team.studentId }}</td>
            <td scope="col">{{ team.studentEmail }}</td>
            <td scope="col"><a class="uploaded_teamwork_item--delete" data-path="{{ path("remove_student_by_id") }}" data-id='{{ team.id }}' href="#">Eliminar</a></td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    <div class="input-group mb-3 w-50">
      <input type="text" class="form-control add_student_input" placeholder="Carnet del estudiante" aria-label="Carnet del estudiante" aria-describedby="button-addon2">
      <div class="input-group-append">
        <button type='button' class='add_student_button btn btn-primary' data-path="{{ path("get_student_by_id") }}" data-list='teamWork'>Agregar miembro</button>

      </div>
      <small id="project_request_team_work_help" class="form-text text-muted">Para agregar un nuevo miembro al equipo, coloque en número de carné y presione el botón "Agregar miembro".</small>
    </div> 
  </div>
  {{ form_row(form.ascriptionUnit) }}
  {{ form_row(form.ucrInstitutions) }}
{% endif %}
{{ form_row(form.extInstitutions) }}

<div class="inline-custom-radio">
  {{ form_row(form.extInstitutionsAuthorization, {attr: {'data-code': 'extInstitutionsAuthorizationFiles', class: 'decision_question'}, label_attr: {class: 'radio-custom'} }) }}
</div>
<div id="extInstitutionsAuthorizationFiles" class="d-none">
  {{ include('commons/_form_uploaded_file.html.twig', {'form_prototype': form.extInstitutionsAuthorizationFiles.vars.prototype, 'files': project_request.infoRequestFiles, 'questionCode': 'extInstitutionsAuthorizationFiles', 'delete_label': 'Eliminar'}) }}

</div>
{{ form_row(form.placeOfStudy) }}
<div class="inline-custom-radio">
  {{ form_row(form.involvesHumans,{label_attr: {class: 'radio-custom'} }) }}
</div>
<div class="inline-custom-radio">
  {{ form_row(form.docHumanInformation,{label_attr: {class: 'radio-custom'} }) }}
</div>

{% if app.user.role.description == "ROLE_RESEARCHER" %}
  <div class="inline-custom-radio">
    {{ form_row(form.minuteCommissionTFG, {attr: {'data-code': 'minuteCommissionTFGFiles', class: 'decision_question'}, label_attr: {class: 'radio-custom'} }) }}
  </div>
  <div id="minuteCommissionTFGFiles" class="d-none">
    {{ include('commons/_form_uploaded_file.html.twig', 
    {'files': project_request.infoRequestFiles, 
    'questionCode': 'minuteCommissionTFGFiles', 
    'form_prototype': form.minuteCommissionTFGFiles.vars.prototype,
    'delete_label': 'Eliminar'}) }}

  </div>
{% endif %}


{% if app.user.role.description == "ROLE_STUDENT" %}
  <div class="inline-custom-radio">
    {{ form_row(form.minutesResearchCenter, {attr: {'data-code': 'minutesResearchCenterFiles', class: 'decision_question'}, label_attr: {class: 'radio-custom'} }) }}
  </div>
  <div id="minutesResearchCenterFiles" class="d-none">
    {{ include('commons/_form_uploaded_file.html.twig', {'form_prototype': form.minutesResearchCenterFiles.vars.prototype, 'files': project_request.infoRequestFiles, 'questionCode': 'minutesResearchCenterFiles', 'delete_label': 'Eliminar'}) }}
  </div>
  <div class="inline-custom-radio">
    {{ form_row(form.minuteFinalWork, {attr: {'data-code': 'minuteFinalWorkFiles', class: 'decision_question'}, label_attr: {class: 'radio-custom'} }) }}
  </div>
  <div id="minuteFinalWorkFiles" class="d-none">
    {{ include('commons/_form_uploaded_file.html.twig', {'form_prototype': form.minuteFinalWorkFiles.vars.prototype, 'files': project_request.infoRequestFiles, 'questionCode': 'minuteFinalWorkFiles', 'delete_label': 'Eliminar'}) }}
  </div>
{% endif %}

{{ form_end(form) }}
{{ include('commons/_form_footer.html.twig') }}